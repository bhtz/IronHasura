@using Microscope.Features.Analytic.Queries
@attribute [Authorize]
@page "/analytic"

<MudToolBar>
    <MudText Typo="Typo.h6">Analytics</MudText>
    <MudSpacer />
    <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="OpenCreateDialog">Add analytic</MudButton>
</MudToolBar>

<MudDataGrid Class="mt-4" T="AnalyticQueryResult" Loading="IsLoading" LoadingProgressColor="Color.Primary" Items="@Analytics" Dense="true" Striped="true" Hover="true" Bordered="true" Filterable="true" QuickFilter="@FilterFunc" Hideable="true" ShowMenuIcon="true">
        <ToolBarContent>
            <MudTextField @bind-Value="SearchTerm" Placeholder="Search" Adornment="Adornment.Start" Immediate="true"
                AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Small" Class="mr-5"></MudTextField>
        </ToolBarContent>
    <Columns>
        <PropertyColumn Property="x => x.Key" Title="Key"/>
        <PropertyColumn Property="x => x.Dimension" Title="Dimension"/>
        <TemplateColumn T="AnalyticQueryResult" Title="Actions" Filterable="false" Sortable="false">
            <CellTemplate>
                <MudIconButton @onclick="() => OnSelectItem(context.Item)" title="Edit" Size="Size.Small" Icon="@Icons.Material.Filled.Edit"></MudIconButton>
                <MudIconButton @onclick="() => Delete(context.Item)" title="Delete" Size="Size.Small" Icon="@Icons.Material.Filled.Delete" Color="Color.Error"></MudIconButton>
            </CellTemplate>
        </TemplateColumn>
    </Columns>
</MudDataGrid>
